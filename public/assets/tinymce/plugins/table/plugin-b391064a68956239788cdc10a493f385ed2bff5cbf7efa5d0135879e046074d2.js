!function(){var e={},t=function(t){for(var n=e[t],r=n.deps,a=n.defn,l=r.length,i=new Array(l),c=0;c<l;++c)i[c]=o(r[c]);var s=a.apply(null,i);if(void 0===s)throw"module ["+t+"] returned undefined";n.instance=s},n=function(t,n,o){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===o)throw"no definition function for "+t;e[t]={deps:n,defn:o,instance:void 0}},o=function(n){var o=e[n];if(void 0===o)throw"module ["+n+"] was undefined";return void 0===o.instance&&t(n),o.instance},r=function(e,t){for(var n=e.length,r=new Array(n),a=0;a<n;++a)r[a]=o(e[a]);t.apply(null,r)};({}).bolt={module:{api:{define:n,require:r,demand:o}}};var a=n,l=function(e,t){a(e,[],function(){return t})};l("c",tinymce.util.Tools.resolve),a("1",["c"],function(e){return e("tinymce.dom.TreeWalker")}),a("2",["c"],function(e){return e("tinymce.Env")}),a("3",["c"],function(e){return e("tinymce.PluginManager")}),a("4",["c"],function(e){return e("tinymce.util.Tools")}),a("5",["c"],function(e){return e("tinymce.util.VK")}),a("a",["2"],function(e){function t(t){(!e.ie||e.ie>9)&&(t.hasChildNodes()||(t.innerHTML='<br data-mce-bogus="1" />'))}var n=function(e){return function(t,n){t&&(n=parseInt(n,10),1===n||0===n?t.removeAttribute(e,1):t.setAttribute(e,n,1))}},o=function(e){return function(t){return parseInt(t.getAttribute(e)||1,10)}};return{setColSpan:n("colSpan"),setRowSpan:n("rowspan"),getColSpan:o("colSpan"),getRowSpan:o("rowSpan"),setSpanVal:function(e,t,o){n(t)(e,o)},getSpanVal:function(e,t){return o(t)(e)},paddCell:t}}),a("d",["4","a"],function(e,t){var n=function(e,t,n){return e[n]?e[n][t]:null},o=function(e,t,o){var r=n(e,t,o);return r?r.elm:null},r=function(e,t,r,a){var l,i,c=0,s=o(e,t,r);for(l=r;(a>0?l<e.length:l>=0)&&(i=n(e,t,l),s===i.elm);l+=a)c++;return c},a=function(e,t,n){for(var o,r=e[n],a=t;a<r.length;a++)if(o=r[a],o.real)return o.elm;return null},l=function(e,n){for(var o,a=[],l=e[n],i=0;i<l.length;i++)o=l[i],a.push({elm:o.elm,above:r(e,i,n,-1)-1,below:r(e,i,n,1)-1}),i+=t.getColSpan(o.elm)-1;return a},i=function(e,n){var o=e.elm.ownerDocument,r=o.createElement("td");return t.setColSpan(r,t.getColSpan(e.elm)),t.setRowSpan(r,n),t.paddCell(r),r},c=function(e,t,n,o){var r=a(e,n+1,o);r?r.parentNode.insertBefore(t,r):(r=a(e,0,o),r.parentNode.appendChild(t))},s=function(e,n,o,r){if(0!==n.above){t.setRowSpan(n.elm,n.above);var a=i(n,n.below+1);return c(e,a,o,r),a}return null},u=function(e,n,o,r){if(0!==n.below){t.setRowSpan(n.elm,n.above+1);var a=i(n,n.below);return c(e,a,o,r+1),a}return null};return{splitAt:function(t,n,r,a){var i=l(t,r),c=o(t,n,r).parentNode,d=[];return e.each(i,function(e,n){null!==(a?s(t,e,n,r):u(t,e,n,r))&&d.push(d)}),{cells:d,row:c}}}}),a("6",["4","2","a","d"],function(e,t,n,o){var r=e.each,a=n.getSpanVal,l=n.setSpanVal;return function(i,c,s){function u(){i.$("td[data-mce-selected],th[data-mce-selected]").removeAttr("data-mce-selected")}function d(e){return e===i.getBody()}function f(t,n){return t?(n=e.map(n.split(","),function(e){return e.toLowerCase()}),e.grep(t.childNodes,function(t){return-1!==e.inArray(n,t.nodeName.toLowerCase())})):[]}function m(){var e=0;q=[],Q=0,r(["thead","tbody","tfoot"],function(t){var n=f(c,t)[0],o=f(n,"tr");r(o,function(n,o){o+=e,r(f(n,"td,th"),function(e,n){var r,l,i,c;if(q[o])for(;q[o][n];)n++;for(i=a(e,"rowspan"),c=a(e,"colspan"),l=o;l<o+i;l++)for(q[l]||(q[l]=[]),r=n;r<n+c;r++)q[l][r]={part:t,real:l==o&&r==n,elm:e,rowspan:i,colspan:c};Q=Math.max(Q,n+1)})}),e+=o.length})}function g(e){return i.fire("newrow",{node:e}),e}function p(e){return i.fire("newcell",{node:e}),e}function h(e,t){return e=e.cloneNode(t),e.removeAttribute("id"),e}function b(e,t){var n;if(n=q[t])return n[e]}function v(e,t){return e[t]?e[t]:null}function w(e,t){for(var n=[],o=0;o<e.length;o++)n.push(b(t,o));return n}function y(e){return e&&(!!ne.getAttrib(e.elm,"data-mce-selected")||e==s)}function x(){var e=[];return r(c.rows,function(t){r(t.cells,function(n){if(ne.getAttrib(n,"data-mce-selected")||s&&n==s.elm)return e.push(t),!1})}),e}function C(){var e=0;return r(q,function(t){if(r(t,function(t){y(t)&&e++}),e)return!1}),e}function S(){var e=ne.createRng();d(c)||(e.setStartAfter(c),e.setEndAfter(c),te.setRng(e),ne.remove(c))}function A(o){var a,c={};return!1!==i.settings.table_clone_elements&&(c=e.makeMap((i.settings.table_clone_elements||"strong em b i span font h1 h2 h3 h4 h5 h6 p div").toUpperCase(),/[ ,]/)),e.walk(o,function(e){var n;if(3==e.nodeType)return r(ne.getParents(e.parentNode,null,o).reverse(),function(e){c[e.nodeName]&&(e=h(e,!1),a?n&&n.appendChild(e):a=n=e,n=e)}),n&&(n.innerHTML=t.ie&&t.ie<10?"&nbsp;":'<br data-mce-bogus="1" />'),!1},"childNodes"),o=h(o,!1),p(o),l(o,"rowSpan",1),l(o,"colSpan",1),a?o.appendChild(a):n.paddCell(o),o}function R(){var e,t=ne.createRng();return r(ne.select("tr",c),function(e){0===e.cells.length&&ne.remove(e)}),0===ne.select("tr",c).length?(t.setStartBefore(c),t.setEndBefore(c),te.setRng(t),void ne.remove(c)):(r(ne.select("thead,tbody,tfoot",c),function(e){0===e.rows.length&&ne.remove(e)}),m(),void(Z&&(e=q[Math.min(q.length-1,Z.y)])&&(te.select(e[Math.min(e.length-1,Z.x)].elm,!0),te.collapse(!0))))}function T(e,t,n,o){var r,a,l,i,c;for(r=q[t][e].elm.parentNode,l=1;l<=n;l++)if(r=ne.getNext(r,"tr")){for(a=e;a>=0;a--)if(c=q[t+l][a].elm,c.parentNode==r){for(i=1;i<=o;i++)ne.insertAfter(A(c),c);break}if(-1==a)for(i=1;i<=o;i++)r.insertBefore(A(r.cells[0]),r.cells[0])}}function N(){r(q,function(e,t){r(e,function(e,n){var o,r,i;if(y(e)&&(e=e.elm,o=a(e,"colspan"),r=a(e,"rowspan"),o>1||r>1)){for(l(e,"rowSpan",1),l(e,"colSpan",1),i=0;i<o-1;i++)ne.insertAfter(A(e),e);T(n,t,r-1,o)}})})}function P(e,t,n){for(var o=[],r=0;r<e.length;r++)(r<t||r>n)&&o.push(e[r]);return o}function B(t){return e.grep(t,function(e){return!1===e.real})}function k(e){for(var t=[],n=0;n<e.length;n++){var o=e[n].elm;t[t.length-1]!==o&&t.push(o)}return t}function I(t,o,r,a,l){var i=0;if(l-r<1)return 0;for(var c=r+1;c<=l;c++){var s=P(v(t,c),o,a),u=B(s);s.length===u.length&&(e.each(k(u),function(e){n.setRowSpan(e,n.getRowSpan(e)-1)}),i++)}return i}function M(t,o,r,a,l){var i=0;if(a-o<1)return 0;for(var c=o+1;c<=a;c++){var s=P(w(t,c),r,l),u=B(s);s.length===u.length&&(e.each(k(u),function(e){n.setColSpan(e,n.getColSpan(e)-1)}),i++)}return i}function D(t,n,o){var a,i,c,s,u,d,f,g,p,h,v,w,x;if(t?(a=G(t),i=a.x,c=a.y,s=i+(n-1),u=c+(o-1)):(Z=ee=null,r(q,function(e,t){r(e,function(e,n){y(e)&&(Z||(Z={x:n,y:t}),ee={x:n,y:t})})}),Z&&(i=Z.x,c=Z.y,s=ee.x,u=ee.y)),g=b(i,c),p=b(s,u),g&&p&&g.part==p.part){N(),m(),w=I(q,i,c,s,u),x=M(q,i,c,s,u),g=b(i,c).elm;var C=s-i-x+1,S=u-c-w+1;for(C===Q&&S===q.length&&(C=1,S=1),C===Q&&S>1&&(S=1),l(g,"colSpan",C),l(g,"rowSpan",S),f=c;f<=u;f++)for(d=i;d<=s;d++)q[f]&&q[f][d]&&(t=q[f][d].elm)!=g&&(h=e.grep(t.childNodes),r(h,function(e){g.appendChild(e)}),h.length&&(h=e.grep(g.childNodes),v=0,r(h,function(e){"BR"==e.nodeName&&v++<h.length-1&&g.removeChild(e)})),ne.remove(t));R()}}function _(e){var t,n,o,i,c,s,u,d,f,m;if(r(q,function(n,o){if(r(n,function(n){if(y(n)&&(n=n.elm,c=n.parentNode,s=g(h(c,!1)),t=o,e))return!1}),e)return void 0===t}),void 0!==t){for(i=0,m=0;i<q[0].length;i+=m)if(q[t][i]&&(n=q[t][i].elm,m=a(n,"colspan"),n!=o)){if(e){if(t>0&&q[t-1][i]&&(d=q[t-1][i].elm,(f=a(d,"rowSpan"))>1)){l(d,"rowSpan",f+1);continue}}else if((f=a(n,"rowspan"))>1){l(n,"rowSpan",f+1);continue}u=A(n),l(u,"colSpan",n.colSpan),s.appendChild(u),o=n}s.hasChildNodes()&&(e?c.parentNode.insertBefore(s,c):ne.insertAfter(s,c))}}function E(e,t){t=t||x().length||1;for(var n=0;n<t;n++)_(e)}function L(e){var t,n;r(q,function(n){if(r(n,function(n,o){if(y(n)&&(t=o,e))return!1}),e)return void 0===t}),r(q,function(o,r){var i,c,s;o[t]&&(i=o[t].elm)!=n&&(s=a(i,"colspan"),c=a(i,"rowspan"),1==s?e?(i.parentNode.insertBefore(A(i),i),T(t,r,c-1,s)):(ne.insertAfter(A(i),i),T(t,r,c-1,s)):l(i,"colSpan",i.colSpan+1),n=i)})}function z(e,t){t=t||C()||1;for(var n=0;n<t;n++)L(e)}function H(t){return e.grep(W(t),y)}function W(e){var t=[];return r(e,function(e){r(e,function(e){t.push(e)})}),t}function O(){var t=[];if(d(c)){if(1==q[0].length)return;if(H(q).length==W(q).length)return}r(q,function(n){r(n,function(n,o){y(n)&&-1===e.inArray(t,o)&&(r(q,function(e){var t,n=e[o].elm;t=a(n,"colSpan"),t>1?l(n,"colSpan",t-1):ne.remove(n)}),t.push(o))})}),R()}function V(){function e(e){var t,n;r(e.cells,function(e){var n=a(e,"rowSpan");n>1&&(l(e,"rowSpan",n-1),t=G(e),T(t.x,t.y,1,1))}),t=G(e.cells[0]),r(q[t.y],function(e){var t;(e=e.elm)!=n&&(t=a(e,"rowSpan"),t<=1?ne.remove(e):l(e,"rowSpan",t-1),n=e)})}var t;t=x(),d(c)&&t.length==c.rows.length||(r(t.reverse(),function(t){e(t)}),R())}function K(){var e=x();if(!d(c)||e.length!=c.rows.length)return ne.remove(e),R(),e}function U(){var e=x();return r(e,function(t,n){e[n]=h(t,!0)}),e}function j(t,n){var i,c,s,d=[];t&&(i=o.splitAt(q,Z.x,Z.y,n),c=i.row,e.each(i.cells,p),s=e.map(t,function(e){return e.cloneNode(!0)}),r(s,function(e,t,o){var i,s,u,f,m=e.cells.length,h=0;for(g(e),i=0;i<m;i++)s=e.cells[i],f=a(s,"colspan"),u=a(s,"rowspan"),h+=f,u>1&&(h--,t+u>o.length?(u=o.length-t,l(s,"rowSpan",u),d.push(o.length-1)):d.push(t+u-1)),p(s);for(r(d,function(e){t<=e&&h++}),i=h;i<Q;i++)e.appendChild(A(e.cells[m-1]));for(i=Q;i<h;i++)s=e.cells[e.cells.length-1],f=a(s,"colspan"),f>1?l(s,"colSpan",f-1):ne.remove(s);n?c.parentNode.insertBefore(e,c):c=ne.insertAfter(e,c)}),u())}function G(e){var t;return r(q,function(n,o){return r(n,function(n,r){if(n.elm==e)return t={x:r,y:o},!1}),!t}),t}function $(e){Z=G(e)}function X(){var e,t;return e=t=0,r(q,function(n,o){r(n,function(n,r){var a,l;y(n)&&(n=q[o][r],r>e&&(e=r),o>t&&(t=o),n.real&&(a=n.colspan-1,l=n.rowspan-1,a&&r+a>e&&(e=r+a),l&&o+l>t&&(t=o+l)))})}),{x:e,y:t}}function Y(e){var t,n,o,r,a,l,i,c,s,d;if(ee=G(e),Z&&ee){for(t=Math.min(Z.x,ee.x),n=Math.min(Z.y,ee.y),o=Math.max(Z.x,ee.x),r=Math.max(Z.y,ee.y),a=o,l=r,d=n;d<=r;d++)for(s=t;s<=o;s++)e=q[d][s],e.real&&(i=e.colspan-1,c=e.rowspan-1,i&&s+i>a&&(a=s+i),c&&d+c>l&&(l=d+c));for(u(),d=n;d<=l;d++)for(s=t;s<=a;s++)q[d][s]&&ne.setAttrib(q[d][s].elm,"data-mce-selected","1")}}function J(e,t){var n,o,r;n=G(e),o=n.y*Q+n.x;do{if(o+=t,!(r=b(o%Q,Math.floor(o/Q))))break;if(r.elm!=e)return te.select(r.elm,!0),ne.isEmpty(r.elm)&&te.collapse(!0),!0}while(r.elm==e);return!1}function F(t){if(Z){var n=o.splitAt(q,Z.x,Z.y,t);e.each(n.cells,p)}}var q,Q,Z,ee,te=i.selection,ne=te.dom;c=c||ne.getParent(te.getStart(!0),"table"),m(),s=s||ne.getParent(te.getStart(!0),"th,td"),s&&(Z=G(s),ee=X(),s=b(Z.x,Z.y)),e.extend(this,{deleteTable:S,split:N,merge:D,insertRow:_,insertRows:E,insertCol:L,insertCols:z,splitCols:F,deleteCols:O,deleteRows:V,cutRows:K,copyRows:U,pasteRows:j,getPos:G,setStartCell:$,setEndCell:Y,moveRelIdx:J,refresh:m})}}),a("7",["6","1","4"],function(e,t,n){return function(o,r){function a(e){o.getBody().style.webkitUserSelect="",(e||p)&&(o.$("td[data-mce-selected],th[data-mce-selected]").removeAttr("data-mce-selected"),p=!1)}function l(e,t){return!(!e||!t)&&e===g.getParent(t,"table")}function i(t){var n,a,i=t.target;if(!f&&!m&&i!==d&&(d=i,u&&s)){if(a=g.getParent(i,"td,th"),l(u,a)||(a=g.getParent(u,"td,th")),s===a&&!p)return;if(r(!0),l(u,a)){t.preventDefault(),c||(c=new e(o,u,s),o.getBody().style.webkitUserSelect="none"),c.setEndCell(a),p=!0,n=o.selection.getSel();try{n.removeAllRanges?n.removeAllRanges():n.empty()}catch(e){}}}}var c,s,u,d,f,m,g=o.dom,p=!0,h=function(){s=c=u=d=null,r(!1)};return o.on("SelectionChange",function(e){p&&e.stopImmediatePropagation()},!0),o.on("MouseDown",function(e){2==e.button||f||m||(a(),s=g.getParent(e.target,"td,th"),u=g.getParent(s,"table"))}),o.on("mouseover",i),o.on("remove",function(){g.unbind(o.getDoc(),"mouseover",i),a()}),o.on("MouseUp",function(){function e(e,o){var a=new t(e,e);do{if(3==e.nodeType&&0!==n.trim(e.nodeValue).length)return void(o?r.setStart(e,0):r.setEnd(e,e.nodeValue.length));if("BR"==e.nodeName)return void(o?r.setStartBefore(e):r.setEndBefore(e))}while(e=o?a.next():a.prev())}var r,a,l,i,u,d=o.selection;if(s){if(c&&(o.getBody().style.webkitUserSelect=""),a=g.select("td[data-mce-selected],th[data-mce-selected]"),a.length>0){r=g.createRng(),i=a[0],r.setStartBefore(i),r.setEndAfter(i),e(i,1),l=new t(i,g.getParent(a[0],"table"));do{if("TD"==i.nodeName||"TH"==i.nodeName){if(!g.getAttrib(i,"data-mce-selected"))break;u=i}}while(i=l.next());e(u),d.setRng(r)}o.nodeChanged(),h()}}),o.on("KeyUp Drop SetContent",function(e){a("setcontent"==e.type),h(),f=!1}),o.on("ObjectResizeStart ObjectResized",function(e){f="objectresized"!=e.type}),o.on("dragstart",function(){m=!0}),o.on("drop dragend",function(){m=!1}),{clear:a}}}),a("8",["4","2"],function(e,t){var n=e.each;return function(o){function r(){var e=o.settings.color_picker_callback;if(e)return function(){var t=this;e.call(o,function(e){t.value(e).fire("change")},t.value())}}function a(e){return{title:"Advanced",type:"form",defaults:{onchange:function(){d(e,this.parents().reverse()[0],"style"==this.name())}},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border color",type:"colorbox",name:"borderColor",onaction:r()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:r()}]}]}}function l(e){return e?e.replace(/px$/,""):""}function i(e){return/^[0-9]+$/.test(e)&&(e+="px"),e}function c(e){n("left center right".split(" "),function(t){o.formatter.remove("align"+t,{},e)})}function s(e){n("top middle bottom".split(" "),function(t){o.formatter.remove("valign"+t,{},e)})}function u(t,n,o){function r(t,o){return o=o||[],e.each(t,function(e){var t={text:e.text||e.title};e.menu?t.menu=r(e.menu):(t.value=e.value,n&&n(t)),o.push(t)}),o}return r(t,o||[])}function d(e,t,n){var o=t.toJSON(),r=e.parseStyle(o.style);n?(t.find("#borderColor").value(r["border-color"]||"")[0].fire("change"),t.find("#backgroundColor").value(r["background-color"]||"")[0].fire("change")):(r["border-color"]=o.borderColor,r["background-color"]=o.backgroundColor),t.find("#style").value(e.serializeStyle(e.parseStyle(e.serializeStyle(r))))}function f(e,t,n){var o=e.parseStyle(e.getAttrib(n,"style"));o["border-color"]&&(t.borderColor=o["border-color"]),o["background-color"]&&(t.backgroundColor=o["background-color"]),t.style=e.serializeStyle(o)}function m(e,t,o){var r=e.parseStyle(e.getAttrib(t,"style"));n(o,function(e){r[e.name]=e.value}),e.setAttrib(t,"style",e.serializeStyle(e.parseStyle(e.serializeStyle(r))))}var g=this;g.tableProps=function(){g.table(!0)},g.table=function(r){function s(){function n(e,t,o){if("TD"===e.tagName||"TH"===e.tagName)x.setStyle(e,t,o);else if(e.children)for(var r=0;r<e.children.length;r++)n(e.children[r],t,o)}var r;d(x,this),C=e.extend(C,this.toJSON()),!1===C["class"]&&delete C["class"],o.undoManager.transact(function(){if(p||(p=o.plugins.table.insertTable(C.cols||1,C.rows||1)),o.dom.setAttribs(p,{style:C.style,"class":C["class"]}),o.settings.table_style_by_css){if(y=[],y.push({name:"border",value:C.border}),y.push({name:"border-spacing",value:i(C.cellspacing)}),m(x,p,y),x.setAttribs(p,{"data-mce-border-color":C.borderColor,"data-mce-cell-padding":C.cellpadding,"data-mce-border":C.border}),p.children)for(var e=0;e<p.children.length;e++)n(p.children[e],"border",C.border),n(p.children[e],"padding",i(C.cellpadding))}else o.dom.setAttribs(p,{border:C.border,cellpadding:C.cellpadding,cellspacing:C.cellspacing});x.getAttrib(p,"width")&&!o.settings.table_style_by_css?x.setAttrib(p,"width",l(C.width)):x.setStyle(p,"width",i(C.width)),x.setStyle(p,"height",i(C.height)),r=x.select("caption",p)[0],r&&!C.caption&&x.remove(r),!r&&C.caption&&(r=x.create("caption"),r.innerHTML=t.ie?"\xa0":'<br data-mce-bogus="1"/>',p.insertBefore(r,p.firstChild)),c(p),C.align&&o.formatter.apply("align"+C.align,{},p),o.focus(),o.addVisual()})}function g(e,t){function n(e,n){for(var o=0;o<n.length;o++){var r=x.getStyle(n[o],t);if(void 0===e&&(e=r),e!=r)return""}return e}var r;return r=n(r,o.dom.select("td,th",e))}var p,h,b,v,w,y,x=o.dom,C={};!0===r?(p=x.getParent(o.selection.getStart(),"table"))&&(C={width:l(x.getStyle(p,"width")||x.getAttrib(p,"width")),height:l(x.getStyle(p,"height")||x.getAttrib(p,"height")),cellspacing:l(x.getStyle(p,"border-spacing")||x.getAttrib(p,"cellspacing")),cellpadding:x.getAttrib(p,"data-mce-cell-padding")||x.getAttrib(p,"cellpadding")||g(p,"padding"),border:x.getAttrib(p,"data-mce-border")||x.getAttrib(p,"border")||g(p,"border"),borderColor:x.getAttrib(p,"data-mce-border-color"),caption:!!x.select("caption",p)[0],"class":x.getAttrib(p,"class")},n("left center right".split(" "),function(e){o.formatter.matchNode(p,"align"+e)&&(C.align=e)})):(h={label:"Cols",name:"cols"},b={label:"Rows",name:"rows"}),o.settings.table_class_list&&(C["class"]&&(C["class"]=C["class"].replace(/\s*mce\-item\-table\s*/g,"")),v={name:"class",type:"listbox",label:"Class",values:u(o.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return o.formatter.getCssText({block:"table",classes:[e.value]})})})}),w={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==o.settings.table_appearance_options?[h,b,{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[h,b,{label:"Width",name:"width"},{label:"Height",name:"height"}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},v]},!1!==o.settings.table_advtab?(f(x,C,p),o.windowManager.open({title:"Table properties",data:C,bodyType:"tabpanel",body:[{title:"General",type:"form",items:w},a(x)],onsubmit:s})):o.windowManager.open({title:"Table properties",data:C,body:w,onsubmit:s})},g.merge=function(e,t){o.windowManager.open({title:"Merge cells",body:[{label:"Cols",name:"cols",type:"textbox",value:"1",size:10},{label:"Rows",name:"rows",type:"textbox",value:"1",size:10}],onsubmit:function(){var n=this.toJSON();o.undoManager.transact(function(){e.merge(t,n.cols,n.rows)})}})},g.cell=function(){function t(e,t,n){(1===v.length||n)&&b.setAttrib(e,t,n)}function r(e,t,n){(1===v.length||n)&&b.setStyle(e,t,n)}function m(){d(b,this),p=e.extend(p,this.toJSON()),o.undoManager.transact(function(){n(v,function(e){t(e,"scope",p.scope),t(e,"style",p.style),t(e,"class",p["class"]),r(e,"width",i(p.width)),r(e,"height",i(p.height)),p.type&&e.nodeName.toLowerCase()!==p.type&&(e=b.rename(e,p.type)),1===v.length&&(c(e),s(e)),p.align&&o.formatter.apply("align"+p.align,{},e),p.valign&&o.formatter.apply("valign"+p.valign,{},e)}),o.focus()})}var g,p,h,b=o.dom,v=[];if(v=o.dom.select("td[data-mce-selected],th[data-mce-selected]"),g=o.dom.getParent(o.selection.getStart(),"td,th"),!v.length&&g&&v.push(g),g=g||v[0]){v.length>1?p={width:"",height:"",scope:"","class":"",align:"",style:"",type:g.nodeName.toLowerCase()}:(p={width:l(b.getStyle(g,"width")||b.getAttrib(g,"width")),height:l(b.getStyle(g,"height")||b.getAttrib(g,"height")),scope:b.getAttrib(g,"scope"),"class":b.getAttrib(g,"class")},p.type=g.nodeName.toLowerCase(),n("left center right".split(" "),function(e){o.formatter.matchNode(g,"align"+e)&&(p.align=e)}),n("top middle bottom".split(" "),function(e){o.formatter.matchNode(g,"valign"+e)&&(p.valign=e)}),f(b,p,g)),o.settings.table_cell_class_list&&(h={name:"class",type:"listbox",label:"Class",values:u(o.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return o.formatter.getCssText({block:"td",classes:[e.value]})})})});var w={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},h]};!1!==o.settings.table_cell_advtab?o.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:p,body:[{title:"General",type:"form",items:w},a(b)],onsubmit:m}):o.windowManager.open({title:"Cell properties",data:p,body:w,onsubmit:m})}},g.row=function(){function t(e,t,n){(1===y.length||n)&&w.setAttrib(e,t,n)}function r(e,t,n){(1===y.length||n)&&w.setStyle(e,t,n)}function s(){var a,l,s;d(w,this),b=e.extend(b,this.toJSON()),o.undoManager.transact(function(){var e=b.type;n(y,function(n){t(n,"scope",b.scope),t(n,"style",b.style),t(n,"class",b["class"]),r(n,"height",i(b.height)),e!==n.parentNode.nodeName.toLowerCase()&&(a=w.getParent(n,"table"),l=n.parentNode,s=w.select(e,a)[0],s||(s=w.create(e),a.firstChild?"CAPTION"===a.firstChild.nodeName?w.insertAfter(s,a.firstChild):a.insertBefore(s,a.firstChild):a.appendChild(s)),s.appendChild(n),l.hasChildNodes()||w.remove(l)),1===y.length&&c(n),b.align&&o.formatter.apply("align"+b.align,{},n)}),o.focus()})}var m,g,p,h,b,v,w=o.dom,y=[];m=o.dom.getParent(o.selection.getStart(),"table"),g=o.dom.getParent(o.selection.getStart(),"td,th"),n(m.rows,function(e){n(e.cells,function(t){if(w.getAttrib(t,"data-mce-selected")||t==g)return y.push(e),!1})}),(p=y[0])&&(y.length>1?b={height:"",scope:"","class":"",align:"",type:p.parentNode.nodeName.toLowerCase()}:(b={height:l(w.getStyle(p,"height")||w.getAttrib(p,"height")),scope:w.getAttrib(p,"scope"),"class":w.getAttrib(p,"class")},b.type=p.parentNode.nodeName.toLowerCase(),n("left center right".split(" "),function(e){o.formatter.matchNode(p,"align"+e)&&(b.align=e)}),f(w,b,p)),o.settings.table_row_class_list&&(h={name:"class",type:"listbox",label:"Class",values:u(o.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return o.formatter.getCssText({block:"tr",classes:[e.value]})})})}),v={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},h]},!1!==o.settings.table_row_advtab?o.windowManager.open({title:"Row properties",data:b,bodyType:"tabpanel",body:[{title:"General",type:"form",items:v},a(w)],onsubmit:s}):o.windowManager.open({title:"Row properties",data:b,body:v,onsubmit:s}))}}}),l("e",clearTimeout),l("f",document),l("g",setTimeout),a("9",["e","f","g","4","5"],function(e,t,n,o,r){var a;return function(l){function i(e,t){return{index:e,y:l.dom.getPos(t).y}}function c(e,t){return{index:e,y:l.dom.getPos(t).y+t.offsetHeight}}function s(e,t){return{index:e,x:l.dom.getPos(t).x}}function u(e,t){return{index:e,x:l.dom.getPos(t).x+t.offsetWidth}}function d(){return"rtl"===l.getBody().dir}function f(){return l.inline}function m(){return f?l.getBody().ownerDocument.body:l.getBody()}function g(e,t){return d()?u(e,t):s(e,t)}function p(e,t){return d()?s(e,t):u(e,t)}function h(e,t){return b(e,"width")/b(t,"width")*100}function b(e,t){var n=l.dom.getStyle(e,t,!0);return parseInt(n,10)}function v(e){return b(e,"width")/b(e.parentElement,"width")*100}function w(e,t){return t/b(e,"width")*100}function y(e,t){return t/b(e.parentElement,"width")*100}function x(e,t,n){for(var o=[],r=1;r<n.length;r++){var a=n[r].element;o.push(e(r-1,a))}var l=n[n.length-1];return o.push(t(n.length-1,l.element)),o}function C(){var e=l.dom.select("."+ge,m());o.each(e,function(e){l.dom.remove(e)})}function S(e){C(),D(e)}function A(e,t,n,o,r,a,l,i){var c={"data-mce-bogus":"all","class":ge+" "+e,unselectable:"on","data-mce-resize":!1,style:"cursor: "+t+"; margin: 0; padding: 0; position: absolute; left: "+n+"px; top: "+o+"px; height: "+r+"px; width: "+a+"px; "};return c[l]=i,c}function R(e,t,n){o.each(e,function(e){var o=n.x,r=e.y-Se/2,a=Se,i=t;l.dom.add(m(),"div",A(pe,he,o,r,a,i,be,e.index))})}function T(e,t,n){o.each(e,function(e){var o=e.x-Se/2,r=n.y,a=t,i=Se;l.dom.add(m(),"div",A(we,ye,o,r,a,i,xe,e.index))})}function N(e){return o.map(e.rows,function(e){return{element:e,cells:o.map(e.cells,function(e){return{element:e,rowspan:e.hasAttribute("rowspan")?parseInt(e.getAttribute("rowspan"),10):1,colspan:e.hasAttribute("colspan")?parseInt(e.getAttribute("colspan"),10):1}})}})}function P(e){function t(e,t){return e+","+t}function n(e,n){return l[t(e,n)]}function r(){var e=[];return o.each(i,function(t){e=e.concat(t.cells)}),e}function a(){return i}var l={},i=[],c=0,s=0;return o.each(e,function(e,n){var r=[];o.each(e.cells,function(e){for(var o=0;void 0!==l[t(n,o)];)o++;for(var a={element:e.element,colspan:e.colspan,rowspan:e.rowspan,rowIndex:n,colIndex:o},i=0;i<e.colspan;i++)for(var u=0;u<e.rowspan;u++){var d=n+u,f=o+i;l[t(d,f)]=a,c=Math.max(c,d+1),s=Math.max(s,f+1)}r.push(a)}),i.push({element:e.element,cells:r})}),{grid:{maxRows:c,maxCols:s},getAt:n,getAllCells:r,getAllRows:a}}function B(e,t){for(var n=[],o=e;o<t;o++)n.push(o);return n}function k(e,t,n){for(var o,r=e(),a=0;a<r.length;a++)t(r[a])&&(o=r[a]);return o||n()}function I(e){var t=B(0,e.grid.maxCols),n=B(0,e.grid.maxRows);return o.map(t,function(t){function o(){for(var o=[],r=0;r<n.length;r++){var a=e.getAt(r,t);a&&a.colIndex===t&&o.push(a)}return o}function r(e){return 1===e.colspan}function a(){for(var o,r=0;r<n.length;r++)if(o=e.getAt(r,t))return o;return null}return k(o,r,a)})}function M(e){var t=B(0,e.grid.maxCols),n=B(0,e.grid.maxRows);return o.map(n,function(n){function o(){for(var o=[],r=0;r<t.length;r++){var a=e.getAt(n,r);a&&a.rowIndex===n&&o.push(a)}return o}function r(e){return 1===e.rowspan}function a(){return e.getAt(n,0)}return k(o,r,a)})}function D(e){var t=N(e),n=P(t),o=M(n),r=I(n),a=l.dom.getPos(e),s=o.length>0?x(i,c,o):[],u=r.length>0?x(g,p,r):[];R(s,e.offsetWidth,a),T(u,e.offsetHeight,a)}function _(e,t,n,o){if(t<0||t>=e.length-1)return"";var r=e[t];if(r)r={value:r,delta:0};else for(var a=e.slice(0,t).reverse(),l=0;l<a.length;l++)a[l]&&(r={value:a[l],delta:l+1});var i=e[t+1];if(i)i={value:i,delta:1};else for(var c=e.slice(t+1),s=0;s<c.length;s++)c[s]&&(i={value:c[s],delta:s+1});var u=i.delta-r.delta,d=Math.abs(i.value-r.value)/u;return n?d/b(o,"width")*100:d}function E(e,t){var n=l.dom.getStyle(e,t);return n||(n=l.dom.getAttrib(e,t)),n||(n=l.dom.getStyle(e,t,!0)),n}function L(e,t,n){var o=E(e,"width"),r=parseInt(o,10),a=t?h(e,n):b(e,"width");return(t&&!G(o)||!t&&!$(o))&&(r=0),!isNaN(r)&&r>0?r:a}function z(e,t,n){for(var r=I(e),a=o.map(r,function(e){return g(e.colIndex,e.element).x}),l=[],i=0;i<r.length;i++){var c=r[i].element.hasAttribute("colspan")?parseInt(r[i].element.getAttribute("colspan"),10):1,s=c>1?_(a,i):L(r[i].element,t,n);s=s||Ae,l.push(s)}return l}function H(e){var t=E(e,"height"),n=parseInt(t,10);return G(t)&&(n=0),!isNaN(n)&&n>0?n:b(e,"height")}function W(e){for(var t=M(e),n=o.map(t,function(e){return i(e.rowIndex,e.element).y}),r=[],a=0;a<t.length;a++){var l=t[a].element.hasAttribute("rowspan")?parseInt(t[a].element.getAttribute("rowspan"),10):1,c=l>1?_(n,a):H(t[a].element);c=c||Re,r.push(c)}return r}function O(e,t,n,r,a){function l(e){return o.map(e,function(){return 0})}function i(){var e;if(a)e=[100-u[0]];else{e=[Math.max(r,u[0]+n)-u[0]]}return e}function c(e,t){var o,a=l(u.slice(0,e)),i=l(u.slice(t+1));if(n>=0){var c=Math.max(r,u[t]-n);o=a.concat([n,c-u[t]]).concat(i)}else{var s=Math.max(r,u[e]+n),d=u[e]-s;o=a.concat([s-u[e],d]).concat(i)}return o}function s(e,t){var o,a=l(u.slice(0,t));if(n>=0)o=a.concat([n]);else{var i=Math.max(r,u[t]+n);o=a.concat([i-u[t]])}return o}var u=e.slice(0);return 0===e.length?[]:1===e.length?i():0===t?c(0,1):t>0&&t<e.length-1?c(t,t+1):t===e.length-1?s(t-1,t):[]}function V(e,t,n){for(var o=0,r=e;r<t;r++)o+=n[r];return o}function K(e,t){var n=e.getAllCells();return o.map(n,function(e){var n=V(e.colIndex,e.colIndex+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}})}function U(e,t){var n=e.getAllCells();return o.map(n,function(e){var n=V(e.rowIndex,e.rowIndex+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}})}function j(e,t){var n=e.getAllRows();return o.map(n,function(e,n){return{element:e.element,height:t[n]}})}function G(e){return Ne.test(e)}function $(e){return Pe.test(e)}function X(e,t,n){function r(e,t){o.each(e,function(e){l.dom.setStyle(e.element,"width",e.width+t),l.dom.setAttrib(e.element,"width",null)})}function a(){return n<u.grid.maxCols-1?v(e):v(e)+y(e,t)}function i(){return n<u.grid.maxCols-1?b(e,"width"):b(e,"width")+t}function c(t,o,r){n!=u.grid.maxCols-1&&r||(l.dom.setStyle(e,"width",t+o),l.dom.setAttrib(e,"width",null))}for(var s=N(e),u=P(s),d=G(e.width)||G(e.style.width),f=z(u,d,e),m=d?w(e,t):t,g=O(f,n,m,Ae,d,e),p=[],h=0;h<g.length;h++)p.push(g[h]+f[h]);var x=K(u,p),C=d?"%":"px",S=d?a():i();l.undoManager.transact(function(){r(x,C),c(S,C,d)})}function Y(e,t,n){for(var r=N(e),a=P(r),i=W(a),c=[],s=0,u=0;u<i.length;u++)c.push(u===n?t+i[u]:i[u]),s+=s[u];var d=U(a,c),f=j(a,c);l.undoManager.transact(function(){o.each(f,function(e){l.dom.setStyle(e.element,"height",e.height+"px"),l.dom.setAttrib(e.element,"height",null)}),o.each(d,function(e){l.dom.setStyle(e.element,"height",e.height+"px"),l.dom.setAttrib(e.element,"height",null)}),l.dom.setStyle(e,"height",s+"px"),l.dom.setAttrib(e,"height",null)})}function J(){ce=n(function(){Z()},200)}function F(){e(ce)}function q(){var e=t.createElement("div");return e.setAttribute("style","margin: 0; padding: 0; position: fixed; left: 0px; top: 0px; height: 100%; width: 100%;"),e.setAttribute("data-mce-bogus","all"),e}function Q(e,t){l.dom.bind(e,"mouseup",function(){Z()}),l.dom.bind(e,"mousemove",function(e){F(),se&&t(e)}),l.dom.bind(e,"mouseout",function(){J()})}function Z(){if(l.dom.remove(ue),se){l.dom.removeClass(de,Te),se=!1;var e,t;if(te(de)){var n=parseInt(l.dom.getAttrib(de,Ce),10),o=l.dom.getPos(de).x;e=parseInt(l.dom.getAttrib(de,xe),10),t=d()?n-o:o-n,Math.abs(t)>=1&&X(a,t,e)}else if(ne(de)){var r=parseInt(l.dom.getAttrib(de,ve),10),i=l.dom.getPos(de).y;e=parseInt(l.dom.getAttrib(de,be),10),t=i-r,Math.abs(t)>=1&&Y(a,t,e)}S(a),l.nodeChanged()}}function ee(e,t){ue=ue||q(),se=!0,l.dom.addClass(e,Te),de=e,Q(ue,t),l.dom.add(m(),ue)}function te(e){return l.dom.hasClass(e,we)}function ne(e){return l.dom.hasClass(e,pe)}function oe(e){fe=void 0!==fe?fe:e.clientX;var t=e.clientX-fe;fe=e.clientX;var n=l.dom.getPos(de).x;l.dom.setStyle(de,"left",n+t+"px")}function re(e){me=void 0!==me?me:e.clientY;var t=e.clientY-me;me=e.clientY;var n=l.dom.getPos(de).y;l.dom.setStyle(de,"top",n+t+"px")}function ae(e){fe=void 0,ee(e,oe)}function le(e){me=void 0,ee(e,re)}function ie(e){var t=e.target,n=l.getBody();if(l.$.contains(n,a)||a===n)if(te(t)){e.preventDefault();var o=l.dom.getPos(t).x;l.dom.setAttrib(t,Ce,o),ae(t)}else if(ne(t)){e.preventDefault();var r=l.dom.getPos(t).y;l.dom.setAttrib(t,ve,r),le(t)}else C()}var ce,se,ue,de,fe,me,ge="mce-resize-bar",pe="mce-resize-bar-row",he="row-resize",be="data-row",ve="data-initial-top",we="mce-resize-bar-col",ye="col-resize",xe="data-col",Ce="data-initial-left",Se=4,Ae=10,Re=10,Te="mce-resize-bar-dragging",Ne=new RegExp(/(\d+(\.\d+)?%)/),Pe=new RegExp(/px|em/);return l.on("init",function(){l.dom.bind(m(),"mousedown",ie)}),l.on("ObjectResized",function(e){var t=e.target;if("TABLE"===t.nodeName){var n=[];o.each(t.rows,function(e){o.each(e.cells,function(e){var t=l.dom.getStyle(e,"width",!0);n.push({cell:e,width:t})})}),o.each(n,function(e){l.dom.setStyle(e.cell,"width",e.width),l.dom.setAttrib(e.cell,"width",null)})}}),l.on("mouseover",function(e){if(!se){var t=l.dom.getParent(e.target,"table");("TABLE"===e.target.nodeName||t)&&(a=t,S(t))}}),l.on("keydown",function(e){switch(e.keyCode){case r.LEFT:case r.RIGHT:case r.UP:case r.DOWN:C()}}),l.on("remove",function(){C(),l.dom.unbind(m(),"mousedown",ie)}),{
adjustWidth:X,adjustHeight:Y,clearBars:C,drawBars:D,determineDeltas:O,getTableGrid:P,getTableDetails:N,getWidths:z,getPixelHeights:W,isPercentageBasedSize:G,isPixelBasedSize:$,recalculateWidths:K,recalculateCellHeights:U,recalculateRowHeights:j}}}),a("h",["c"],function(e){return e("tinymce.util.Delay")}),a("b",["5","h","2","4","a"],function(e,t,n,o,r){var a=o.each,l=r.getSpanVal;return function(i){function c(){function n(n){function o(e,t){var o=e?"previousSibling":"nextSibling",a=i.dom.getParent(t,"tr"),l=a[o];if(l)return b(i,t,l,e),n.preventDefault(),!0;var c=i.dom.getParent(a,"table"),d=a.parentNode,f=d.nodeName.toLowerCase();if("tbody"===f||f===(e?"tfoot":"thead")){var m=r(e,c,d,"tbody");if(null!==m)return s(e,m,t)}return u(e,a,o,c)}function r(e,t,n,o){var r=i.dom.select(">"+o,t),a=r.indexOf(n);if(e&&0===a||!e&&a===r.length-1)return c(e,t);if(-1===a){return r["thead"===n.tagName.toLowerCase()?0:r.length-1]}return r[a+(e?-1:1)]}function c(e,t){var n=e?"thead":"tfoot",o=i.dom.select(">"+n,t);return 0!==o.length?o[0]:null}function s(e,t,o){var r=d(t,e);return r&&b(i,o,r,e),n.preventDefault(),!0}function u(e,t,r,a){var l=a[r];if(l)return f(l),!0;var c=i.dom.getParent(a,"td,th");return c?o(e,c,n):(f(d(t,!e)),n.preventDefault(),!1)}function d(e,t){var n=e&&e[t?"lastChild":"firstChild"];return n&&"BR"===n.nodeName?i.dom.getParent(n,"td,th"):n}function f(e){i.selection.select(e,!0),i.selection.collapse(!0)}function m(){return y==e.UP||y==e.DOWN}function g(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}function p(e){for(var t=0,n=e;n.previousSibling;)n=n.previousSibling,t+=l(n,"colspan");return t}function h(e,t){var n=0,o=0;return a(e.children,function(e,r){if(n+=l(e,"colspan"),o=r,n>t)return!1}),o}function b(e,t,n,o){var r=p(i.dom.getParent(t,"td,th")),a=h(n,r),l=n.childNodes[a];f(d(l,o)||l)}function v(e){var t=i.selection.getNode(),n=i.dom.getParent(t,"td,th"),o=i.dom.getParent(e,"td,th");return n&&n!==o&&w(n,o)}function w(e,t){return i.dom.getParent(e,"TABLE")===i.dom.getParent(t,"TABLE")}var y=n.keyCode;if(m()&&g(i)){var x=i.selection.getNode();t.setEditorTimeout(i,function(){v(x)&&o(!n.shiftKey&&y===e.UP,x,n)},0)}}i.on("KeyDown",function(e){n(e)})}function s(){function e(e,t){var n,o=t.ownerDocument,r=o.createRange();return r.setStartBefore(t),r.setEnd(e.endContainer,e.endOffset),n=o.createElement("body"),n.appendChild(r.cloneContents()),0===n.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length}i.on("KeyDown",function(t){var n,o,r=i.dom;37!=t.keyCode&&38!=t.keyCode||(n=i.selection.getRng(),(o=r.getParent(n.startContainer,"table"))&&i.getBody().firstChild==o&&e(n,o)&&(n=r.createRng(),n.setStartBefore(o),n.setEndBefore(o),i.selection.setRng(n),t.preventDefault()))})}function u(){i.on("KeyDown SetContent VisualAid",function(){var e;for(e=i.getBody().lastChild;e;e=e.previousSibling)if(3==e.nodeType){if(e.nodeValue.length>0)break}else if(1==e.nodeType&&("BR"==e.tagName||!e.getAttribute("data-mce-bogus")))break;e&&"TABLE"==e.nodeName&&(i.settings.forced_root_block?i.dom.add(i.getBody(),i.settings.forced_root_block,i.settings.forced_root_block_attrs,n.ie&&n.ie<10?"&nbsp;":'<br data-mce-bogus="1" />'):i.dom.add(i.getBody(),"br",{"data-mce-bogus":"1"}))}),i.on("PreProcess",function(e){var t=e.node.lastChild;t&&("BR"==t.nodeName||1==t.childNodes.length&&("BR"==t.firstChild.nodeName||"\xa0"==t.firstChild.nodeValue))&&t.previousSibling&&"TABLE"==t.previousSibling.nodeName&&i.dom.remove(t)})}function d(){function e(e,t,n,o){var r,a,l,i=e.dom.getParent(t.startContainer,"TABLE");return i&&(r=i.parentNode),a=3==t.startContainer.nodeType&&0===t.startOffset&&0===t.endOffset&&o&&("TR"==n.nodeName||n==r),l=("TD"==n.nodeName||"TH"==n.nodeName)&&!o,a||l}function t(){var t=i.selection.getRng(),n=i.selection.getNode(),o=i.dom.getParent(t.startContainer,"TD,TH");if(e(i,t,n,o)){o||(o=n);for(var r=o.lastChild;r.lastChild;)r=r.lastChild;3==r.nodeType&&(t.setEnd(r,r.data.length),i.selection.setRng(t))}}i.on("KeyDown",function(){t()}),i.on("MouseDown",function(e){2!=e.button&&t()})}function f(){function t(e){i.selection.select(e,!0),i.selection.collapse(!0)}function n(e){i.$(e).empty(),r.paddCell(e)}i.on("keydown",function(r){if((r.keyCode==e.DELETE||r.keyCode==e.BACKSPACE)&&!r.isDefaultPrevented()){var a,l,c,s;if(a=i.dom.getParent(i.selection.getStart(),"table")){if(l=i.dom.select("td,th",a),c=o.grep(l,function(e){return!!i.dom.getAttrib(e,"data-mce-selected")}),0===c.length)return s=i.dom.getParent(i.selection.getStart(),"td,th"),void(i.selection.isCollapsed()&&s&&i.dom.isEmpty(s)&&(r.preventDefault(),n(s),t(s)));r.preventDefault(),i.undoManager.transact(function(){l.length==c.length?i.execCommand("mceTableDelete"):(o.each(c,n),t(c[0]))})}}})}function m(){var t="\ufeff",n=function(e){return i.dom.isEmpty(e)||e.firstChild===e.lastChild&&a(e.firstChild)},o=function(e){return e&&"CAPTION"==e.nodeName&&"TABLE"==e.parentNode.nodeName},r=function(e,t){var n=t.firstChild;do{if(n===e)return!0}while(n=n.firstChild);return!1},a=function(e){if(3===e.nodeType){if(e.data===t)return!0;e=e.parentNode}return 1===e.nodeType&&e.hasAttribute("data-mce-caret")},l=function(e){var t=i.selection.getRng();return!t.startOffset&&!t.startContainer.previousSibling&&r(t.startContainer,e)},c=function(e,n){var o;o=n?i.dom.create("p",{"data-mce-caret":"after","data-mce-bogus":"all"},'<br data-mce-bogus="1">'):e.ownerDocument.createTextNode(t),e.appendChild(o)},s=function(e){var o=e.lastChild,r=i.selection.getRng(),l=r.startContainer,s=r.startOffset;n(e)?(e.innerHTML=t,l=e.lastChild,s=0):a(o)||c(e,i.dom.isBlock(o)),i.selection.setCursorLocation(l,s)},u=function(e){var t=i.selection.getRng(),n=i.dom.createRng(),o=e.firstChild;t.commonAncestorContainer===e.parentNode&&r(t.startContainer,e)&&(n.setStart(e,0),1===o.nodeType?n.setEnd(e,e.childNodes.length):n.setEnd(o,o.nodeValue.length),i.selection.setRng(n))};i.on("keydown",function(t){if(!(t.keyCode!==e.DELETE&&t.keyCode!==e.BACKSPACE||t.isDefaultPrevented())){var r=i.dom.getParent(i.selection.getStart(),"caption");o(r)&&(i.selection.isCollapsed()?(s(r),(n(r)||t.keyCode===e.BACKSPACE&&l(r))&&t.preventDefault()):(u(r),i.undoManager.transact(function(){i.execCommand("Delete"),s(r)}),t.preventDefault()))}})}m(),f(),n.webkit&&(c(),d()),n.gecko&&(s(),u()),n.ie>9&&(s(),u())}}),a("0",["1","2","3","4","5","6","7","8","9","a","b"],function(e,t,n,o,r,a,l,i,c,s,u){function d(e){function n(t){return function(){e.execCommand(t)}}function d(n,o){var r,a,l,i;for(l='<table id="__mce"><tbody>',r=0;r<o;r++){for(l+="<tr>",a=0;a<n;a++)l+="<td>"+(t.ie&&t.ie<10?"&nbsp;":"<br>")+"</td>";l+="</tr>"}return l+="</tbody></table>",e.undoManager.transact(function(){e.insertContent(l),i=e.dom.get("__mce"),e.dom.setAttrib(i,"id",null),e.$("tr",i).each(function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each(function(t,n){e.fire("newcell",{node:n})})}),e.dom.setAttribs(i,e.settings.table_default_attributes||{}),e.dom.setStyles(i,e.settings.table_default_styles||{})}),i}function m(t,n,o){function r(){var r,a,l,i={},c=0;a=e.dom.select("td[data-mce-selected],th[data-mce-selected]"),r=a[0],r||(r=e.selection.getStart()),o&&a.length>0?(f(a,function(e){return i[e.parentNode.parentNode.nodeName]=1}),f(i,function(e){c+=e}),l=1!==c):l=!e.dom.getParent(r,n),t.disabled(l),e.selection.selectorChanged(n,function(e){t.disabled(!e)})}e.initialized?r():e.on("init",r)}function g(){m(this,"table")}function p(){m(this,"td,th")}function h(){m(this,"td,th",!0)}function b(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}function v(t,n,o){var r,a,l,i,c,s=o.getEl().getElementsByTagName("table")[0],u=o.isRtl()||"tl-tr"==o.parent().rel;for(s.nextSibling.innerHTML=t+1+" x "+(n+1),u&&(t=9-t),a=0;a<10;a++)for(r=0;r<10;r++)i=s.rows[a].childNodes[r].firstChild,c=(u?r>=t:r<=t)&&a<=n,e.dom.toggleClass(i,"mce-active",c),c&&(l=i);return l.parentNode}function w(){e.addButton("tableprops",{title:"Table properties",onclick:N.tableProps,icon:"table"}),e.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),e.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),e.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),e.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),e.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),e.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),e.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),e.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),e.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),e.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),e.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),e.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),e.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),e.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),e.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})}function y(t){return e.dom.is(t,"table")&&e.getBody().contains(t)}function x(){var t=e.settings.table_toolbar;""!==t&&!1!==t&&(t||(t="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),e.addContextToolbar(y,t))}function C(){return A}function S(e){A=e}var A,R,T=this,N=new i(e);!e.settings.object_resizing||!1===e.settings.table_resize_bars||!0!==e.settings.object_resizing&&"table"!==e.settings.object_resizing||(R=c(e));var P=function(t){var n=e.dom.getParent(t,"th,td"),r=e.dom.select("td[data-mce-selected],th[data-mce-selected]").concat(n?[n]:[]);return o.grep(r,function(e){return s.getColSpan(e)>1||s.getRowSpan(e)>1}).length>0},B=function(t){var n=t.control;n.disabled(!P(e.selection.getStart())),e.on("nodechange",function(e){n.disabled(!P(e.element))})};!1===e.settings.table_grid?e.addMenuItem("inserttable",{text:"Table",icon:"table",context:"table",onclick:N.table}):e.addMenuItem("inserttable",{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),N.table())},onshow:function(){v(0,0,this.menu.items()[0])},onhide:function(){var t=this.menu.items()[0].getEl().getElementsByTagName("a");e.dom.removeClass(t,"mce-active"),e.dom.addClass(t[0],"mce-active")},menu:[{type:"container",html:b(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var t,n,o=e.target;"A"==o.tagName.toUpperCase()&&(t=parseInt(o.getAttribute("data-mce-x"),10),n=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"==this.parent().rel)&&(t=9-t),t===this.lastX&&n===this.lastY||(v(t,n,e.control),this.lastX=t,this.lastY=n))},onclick:function(t){var n=this;"A"==t.target.tagName.toUpperCase()&&(t.preventDefault(),t.stopPropagation(),n.parent().cancel(),e.undoManager.transact(function(){d(n.lastX+1,n.lastY+1)}),e.addVisual())}}]}),e.addMenuItem("tableprops",{text:"Table properties",context:"table",onPostRender:g,onclick:N.tableProps}),e.addMenuItem("deletetable",{text:"Delete table",context:"table",onPostRender:g,cmd:"mceTableDelete"}),e.addMenuItem("cell",{separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:n("mceTableCellProps"),onPostRender:p},{text:"Merge cells",onclick:n("mceTableMergeCells"),onPostRender:h},{text:"Split cell",disabled:!0,onclick:n("mceTableSplitCells"),onPostRender:B}]}),e.addMenuItem("row",{text:"Row",context:"table",menu:[{text:"Insert row before",onclick:n("mceTableInsertRowBefore"),onPostRender:p},{text:"Insert row after",onclick:n("mceTableInsertRowAfter"),onPostRender:p},{text:"Delete row",onclick:n("mceTableDeleteRow"),onPostRender:p},{text:"Row properties",onclick:n("mceTableRowProps"),onPostRender:p},{text:"-"},{text:"Cut row",onclick:n("mceTableCutRow"),onPostRender:p},{text:"Copy row",onclick:n("mceTableCopyRow"),onPostRender:p},{text:"Paste row before",onclick:n("mceTablePasteRowBefore"),onPostRender:p},{text:"Paste row after",onclick:n("mceTablePasteRowAfter"),onPostRender:p}]}),e.addMenuItem("column",{text:"Column",context:"table",menu:[{text:"Insert column before",onclick:n("mceTableInsertColBefore"),onPostRender:p},{text:"Insert column after",onclick:n("mceTableInsertColAfter"),onPostRender:p},{text:"Delete column",onclick:n("mceTableDeleteCol"),onPostRender:p}]});var k=[];f("inserttable tableprops deletetable | cell row column".split(" "),function(t){"|"==t?k.push({text:"-"}):k.push(e.menuItems[t])}),e.addButton("table",{type:"menubutton",title:"Table",menu:k}),t.isIE||e.on("click",function(t){t=t.target,"TABLE"===t.nodeName&&(e.selection.select(t),e.nodeChanged())}),T.quirks=new u(e),e.on("Init",function(){T.cellSelection=new l(e,function(e){e&&R&&R.clearBars()}),T.resizeBars=R}),e.on("PreInit",function(){e.serializer.addAttributeFilter("data-mce-cell-padding,data-mce-border,data-mce-border-color",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})}),f({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(t){var n;n=e.dom.getParent(e.selection.getStart(),"th,td"),e.dom.select("td[data-mce-selected],th[data-mce-selected]").length?t.merge():N.merge(t,n)},mceTableInsertRowBefore:function(e){e.insertRows(!0)},mceTableInsertRowAfter:function(e){e.insertRows()},mceTableInsertColBefore:function(e){e.insertCols(!0)},mceTableInsertColAfter:function(e){e.insertCols()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){A=e.cutRows()},mceTableCopyRow:function(e){A=e.copyRows()},mceTablePasteRowBefore:function(e){e.pasteRows(A,!0)},mceTablePasteRowAfter:function(e){e.pasteRows(A)},mceSplitColsBefore:function(e){e.splitCols(!0)},mceSplitColsAfter:function(e){e.splitCols(!1)},mceTableDelete:function(e){R&&R.clearBars(),e.deleteTable()}},function(t,n){e.addCommand(n,function(){var n=new a(e);n&&(t(n),e.execCommand("mceRepaint"),T.cellSelection.clear())})}),f({mceInsertTable:N.table,mceTableProps:function(){N.table(!0)},mceTableRowProps:N.row,mceTableCellProps:N.cell},function(t,n){e.addCommand(n,function(e,n){t(n)})}),w(),x(),!1!==e.settings.table_tab_navigation&&e.on("keydown",function(t){var n,o,l,i=e.selection.getStart();if(t.keyCode===r.TAB){if(e.dom.getParent(i,"LI,DT,DD"))return;(n=e.dom.getParent(i,"th,td"))&&(t.preventDefault(),o=new a(e),l=t.shiftKey?-1:1,e.undoManager.transact(function(){!o.moveRelIdx(n,l)&&l>0&&(o.insertRow(),o.refresh(),o.moveRelIdx(n,l))}))}}),T.insertTable=d,T.setClipboardRows=S,T.getClipboardRows=C}var f=o.each;return n.add("table",d),function(){}}),o("0")()}();