!function(){var e={},t=function(t){for(var n=e[t],o=n.deps,a=n.defn,i=o.length,u=new Array(i),s=0;s<i;++s)u[s]=r(o[s]);var c=a.apply(null,u);if(c===undefined)throw"module ["+t+"] returned undefined";n.instance=c},n=function(t,n,r){if("string"!=typeof t)throw"module id must be a string";if(n===undefined)throw"no dependencies for "+t;if(r===undefined)throw"no definition function for "+t;e[t]={deps:n,defn:r,instance:undefined}},r=function(n){var r=e[n];if(r===undefined)throw"module ["+n+"] was undefined";return r.instance===undefined&&t(n),r.instance},o=function(e,t){for(var n=e.length,o=new Array(n),a=0;a<n;++a)o[a]=r(e[a]);t.apply(null,o)};({}).bolt={module:{api:{define:n,require:o,demand:r}}};var a=n,i=function(e,t){a(e,[],function(){return t})};a("ephox.katamari.api.Cell",[],function(){var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return e(r())}}};return e}),i("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve),a("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.PluginManager")}),i("global!setInterval",setInterval),a("tinymce.core.util.LocalStorage",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.LocalStorage")}),a("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.Tools")}),a("tinymce.plugins.autosave.api.Events",[],function(){return{fireRestoreDraft:function(e){return e.fire("RestoreDraft")},fireStoreDraft:function(e){return e.fire("StoreDraft")},fireRemoveDraft:function(e){return e.fire("RemoveDraft")}}}),i("global!document",document),a("tinymce.plugins.autosave.core.Time",[],function(){return{parse:function(e,t){var n={s:1e3,m:6e4};return e=/^(\d+)([ms]?)$/.exec(""+(e||t)),(e[2]?n[e[2]]:1)*parseInt(e,10)}}}),a("tinymce.plugins.autosave.api.Settings",["global!document","tinymce.plugins.autosave.core.Time"],function(e,t){return{shouldAskBeforeUnload:function(e){return e.getParam("autosave_ask_before_unload",!0)},getAutoSavePrefix:function(t){var n=t.getParam("autosave_prefix","tinymce-autosave-{path}{query}{hash}-{id}-");return n=n.replace(/\{path\}/g,e.location.pathname),n=n.replace(/\{query\}/g,e.location.search),n=n.replace(/\{hash\}/g,e.location.hash),n=n.replace(/\{id\}/g,t.id)},shouldRestoreWhenEmpty:function(e){return e.getParam("autosave_restore_when_empty",!1)},getAutoSaveInterval:function(e){return t.parse(e.settings.autosave_interval,"30s")},getAutoSaveRetention:function(e){return t.parse(e.settings.autosave_retention,"20m")}}}),a("tinymce.plugins.autosave.core.Storage",["global!setInterval","tinymce.core.util.LocalStorage","tinymce.core.util.Tools","tinymce.plugins.autosave.api.Events","tinymce.plugins.autosave.api.Settings"],function(e,t,n,r,o){var a=function(e,t){var r=e.settings.forced_root_block;return""===(t=n.trim(void 0===t?e.getBody().innerHTML:t))||new RegExp("^<"+r+"[^>]*>((\xa0|&nbsp;|[ \t]|<br[^>]*>)+?|)</"+r+">|<br>$","i").test(t)},i=function(e){var n=parseInt(t.getItem(o.getAutoSavePrefix(e)+"time"),10)||0;return!((new Date).getTime()-n>o.getAutoSaveRetention(e))||(u(e,!1),!1)},u=function(e,n){var a=o.getAutoSavePrefix(e);t.removeItem(a+"draft"),t.removeItem(a+"time"),!1!==n&&r.fireRemoveDraft(e)},s=function(e){var n=o.getAutoSavePrefix(e);!a(e)&&e.isDirty()&&(t.setItem(n+"draft",e.getContent({format:"raw",no_events:!0})),t.setItem(n+"time",(new Date).getTime()),r.fireStoreDraft(e))},c=function(e){var n=o.getAutoSavePrefix(e);i(e)&&(e.setContent(t.getItem(n+"draft"),{format:"raw"}),r.fireRestoreDraft(e))};return{isEmpty:a,hasDraft:i,removeDraft:u,storeDraft:s,restoreDraft:c,startStoreDraft:function(t,n){var r=o.getAutoSaveInterval(t);n.get()||(e(function(){t.removed||s(t)},r),n.set(!0))},restoreLastDraft:function(e){e.undoManager.transact(function(){c(e),u(e)}),e.focus()}}}),a("tinymce.plugins.autosave.api.Api",["tinymce.plugins.autosave.core.Storage"],function(e){var t=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[t].concat(n))}};return{get:function(n){return{hasDraft:t(e.hasDraft,n),storeDraft:t(e.storeDraft,n),restoreDraft:t(e.restoreDraft,n),removeDraft:t(e.removeDraft,n),isEmpty:t(e.isEmpty,n)}}}}),i("global!window",window),a("tinymce.core.EditorManager",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.EditorManager")}),a("tinymce.plugins.autosave.core.BeforeUnload",["global!window","tinymce.core.EditorManager","tinymce.core.util.Tools","tinymce.plugins.autosave.api.Settings"],function(e,t,n,r){return t._beforeUnloadHandler=function(){var e;return n.each(t.get(),function(t){t.plugins.autosave&&t.plugins.autosave.storeDraft(),!e&&t.isDirty()&&r.shouldAskBeforeUnload(t)&&(e=t.translate("You have unsaved changes are you sure you want to navigate away?"))}),e},{setup:function(){e.onbeforeunload=t._beforeUnloadHandler}}}),a("tinymce.plugins.autosave.ui.Buttons",["tinymce.plugins.autosave.core.Storage"],function(e){var t=function(t,n){return function(r){var o=r.control;o.disabled(!e.hasDraft(t)),t.on("StoreDraft RestoreDraft RemoveDraft",function(){o.disabled(!e.hasDraft(t))}),e.startStoreDraft(t,n)}};return{register:function(n,r){n.addButton("restoredraft",{title:"Restore last draft",onclick:function(){e.restoreLastDraft(n)},onPostRender:t(n,r)}),n.addMenuItem("restoredraft",{text:"Restore last draft",onclick:function(){e.restoreLastDraft(n)},onPostRender:t(n,r),context:"file"})}}}),a("tinymce.plugins.autosave.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.autosave.api.Api","tinymce.plugins.autosave.core.BeforeUnload","tinymce.plugins.autosave.ui.Buttons"],function(e,t,n,r,o){return t.add("autosave",function(t){var a=e(!1);return r.setup(t),o.register(t,a),n.get(t)}),function(){}}),r("tinymce.plugins.autosave.Plugin")()}();