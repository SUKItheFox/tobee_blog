!function(){var e={},t=function(t){for(var n=e[t],i=n.deps,r=n.defn,l=i.length,o=new Array(l),c=0;c<l;++c)o[c]=a(i[c]);var u=r.apply(null,o);if(u===undefined)throw"module ["+t+"] returned undefined";n.instance=u},n=function(t,n,a){if("string"!=typeof t)throw"module id must be a string";if(n===undefined)throw"no dependencies for "+t;if(a===undefined)throw"no definition function for "+t;e[t]={deps:n,defn:a,instance:undefined}},a=function(n){var a=e[n];if(a===undefined)throw"module ["+n+"] was undefined";return a.instance===undefined&&t(n),a.instance},i=function(e,t){for(var n=e.length,i=new Array(n),r=0;r<n;++r)i[r]=a(e[r]);t.apply(null,i)};({}).bolt={module:{api:{define:n,require:i,demand:a}}};var r=n,l=function(e,t){r(e,[],function(){return t})};l("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve),r("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.PluginManager")}),l("global!Array",Array),l("global!Error",Error),r("ephox.katamari.api.Fun",["global!Array","global!Error"],function(e,t){var n=function(){},a=function(e,t){return function(){return e(t.apply(null,arguments))}},i=function(e){return function(){return e}};return{noop:n,compose:a,constant:i,identity:function(e){return e},tripleEquals:function(e,t){return e===t},curry:function(t){for(var n=new e(arguments.length-1),a=1;a<arguments.length;a++)n[a-1]=arguments[a];return function(){for(var a=new e(arguments.length),i=0;i<a.length;i++)a[i]=arguments[i];var r=n.concat(a);return t.apply(null,r)}},not:function(e){return function(){return!e.apply(null,arguments)}},die:function(e){return function(){throw new t(e)}},apply:function(e){return e()},call:function(e){e()},never:i(!1),always:i(!0)}}),r("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.Tools")}),r("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.XHR")}),r("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.dom.DOMUtils")}),r("tinymce.plugins.template.api.Settings",["tinymce.core.dom.DOMUtils"],function(e){return{getCreationDateClasses:function(e){return e.getParam("template_cdate_classes","cdate")},getModificationDateClasses:function(e){return e.getParam("template_mdate_classes","mdate")},getSelectedContentClasses:function(e){return e.getParam("template_selected_content_classes","selcontent")},getPreviewReplaceValues:function(e){return e.getParam("template_preview_replace_values")},getTemplateReplaceValues:function(e){return e.getParam("template_replace_values")},getTemplates:function(e){return e.templates},getCdateFormat:function(e){return e.getParam("template_cdate_format",e.getLang("template.cdate_format"))},getMdateFormat:function(e){return e.getParam("template_mdate_format",e.getLang("template.mdate_format"))},getDialogWidth:function(e){return e.getParam("template_popup_width",600)},getDialogHeight:function(t){return Math.min(e.DOM.getViewPort().h,t.getParam("template_popup_height",500))}}}),r("tinymce.plugins.template.core.DateTimeHelper",[],function(){var e=function(e,t){if(e=""+e,e.length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e};return{getDateTime:function(t,n,a){var i="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),r="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),o="January February March April May June July August September October November December".split(" ");return a=a||new Date,n=n.replace("%D","%m/%d/%Y"),n=n.replace("%r","%I:%M:%S %p"),n=n.replace("%Y",""+a.getFullYear()),n=n.replace("%y",""+a.getYear()),n=n.replace("%m",e(a.getMonth()+1,2)),n=n.replace("%d",e(a.getDate(),2)),n=n.replace("%H",""+e(a.getHours(),2)),n=n.replace("%M",""+e(a.getMinutes(),2)),n=n.replace("%S",""+e(a.getSeconds(),2)),n=n.replace("%I",""+((a.getHours()+11)%12+1)),n=n.replace("%p",a.getHours()<12?"AM":"PM"),n=n.replace("%B",""+t.translate(o[a.getMonth()])),n=n.replace("%b",""+t.translate(l[a.getMonth()])),n=n.replace("%A",""+t.translate(r[a.getDay()])),n=n.replace("%a",""+t.translate(i[a.getDay()])),n=n.replace("%%","%")}}}),r("tinymce.plugins.template.core.Templates",["tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper"],function(e,t,n,a){var i=function(e,a){return function(){var i=n.getTemplates(e);if("function"==typeof i)return void i(a);"string"==typeof i?t.send({url:i,success:function(e){a(JSON.parse(e))}}):a(i)}},r=function(t,n,a){return e.each(a,function(e,t){"function"==typeof e&&(e=e(t)),n=n.replace(new RegExp("\\{\\$"+t+"\\}","g"),e)}),n},l=function(t,a){var i=t.dom,r=n.getTemplateReplaceValues(t);e.each(i.select("*",a),function(t){e.each(r,function(e,n){i.hasClass(t,n)&&"function"==typeof r[n]&&r[n](t)})})},o=function(e,t){return new RegExp("\\b"+t+"\\b","g").test(e.className)};return{createTemplateList:i,replaceTemplateValues:r,replaceVals:l,insertTemplate:function(t,i,c){var u,s,p=t.dom,m=t.selection.getContent();c=r(t,c,n.getTemplateReplaceValues(t)),u=p.create("div",null,c),s=p.select(".mceTmpl",u),s&&s.length>0&&(u=p.create("div",null),u.appendChild(s[0].cloneNode(!0))),e.each(p.select("*",u),function(e){o(e,n.getCreationDateClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=a.getDateTime(t,n.getCdateFormat(t))),o(e,n.getModificationDateClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=a.getDateTime(t,n.getMdateFormat(t))),o(e,n.getSelectedContentClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=m)}),l(t,u),t.execCommand("mceInsertContent",!1,u.innerHTML),t.addVisual()}}}),r("tinymce.plugins.template.api.Commands",["ephox.katamari.api.Fun","tinymce.plugins.template.core.Templates"],function(e,t){return{register:function(n){n.addCommand("mceInsertTemplate",e.curry(t.insertTemplate,n))}}}),r("tinymce.plugins.template.core.FilterContent",["tinymce.core.util.Tools","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper","tinymce.plugins.template.core.Templates"],function(e,t,n,a){return{setup:function(i){i.on("PreProcess",function(r){var l=i.dom,o=t.getMdateFormat(i);e.each(l.select("div",r.node),function(t){l.hasClass(t,"mceTmpl")&&(e.each(l.select("*",t),function(e){l.hasClass(e,i.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(e.innerHTML=n.getDateTime(i,o))}),a.replaceVals(i,t))})})}}}),r("tinymce.plugins.template.ui.Dialog",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.Templates"],function(e,t,n,a,i){var r=function(e,n,r){if(-1===r.indexOf("<html>")){var l="";t.each(e.contentCSS,function(t){l+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(t)+'">'});var o=e.settings.body_class||"";-1!==o.indexOf("=")&&(o=e.getParam("body_class","","hash"),o=o[e.id]||""),r="<!DOCTYPE html><html><head>"+l+'</head><body class="'+o+'">'+r+"</body></html>"}r=i.replaceTemplateValues(e,r,a.getPreviewReplaceValues(e));var c=n.find("iframe")[0].getEl().contentWindow.document;c.open(),c.write(r),c.close()};return{open:function(e,l){var o,c,u=[];if(!l||0===l.length){var s=e.translate("No templates defined.");return void e.notificationManager.open({text:s,type:"info"})}t.each(l,function(e){u.push({selected:!u.length,text:e.title,value:{url:e.url,content:e.content,description:e.description}})});var p=function(t){var a=t.control.value();a.url?n.send({url:a.url,success:function(t){c=t,r(e,o,c)}}):(c=a.content,r(e,o,c)),o.find("#description")[0].text(t.control.value().description)};o=e.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:u,onselect:p}}]},{type:"label",name:"description",label:"Description",text:"\xa0"},{type:"iframe",flex:1,border:1}],onsubmit:function(){i.insertTemplate(e,!1,c)},minWidth:a.getDialogWidth(e),minHeight:a.getDialogHeight(e)}),o.find("listbox")[0].fire("select")}}}),r("tinymce.plugins.template.ui.Buttons",["tinymce.plugins.template.core.Templates","tinymce.plugins.template.ui.Dialog"],function(e,t){var n=function(e){return function(n){t.open(e,n)}};return{register:function(t){t.addButton("template",{title:"Insert template",onclick:e.createTemplateList(t.settings,n(t))}),t.addMenuItem("template",{text:"Template",onclick:e.createTemplateList(t.settings,n(t)),icon:"template",context:"insert"})}}}),r("tinymce.plugins.template.Plugin",["tinymce.core.PluginManager","tinymce.plugins.template.api.Commands","tinymce.plugins.template.core.FilterContent","tinymce.plugins.template.ui.Buttons"],function(e,t,n,a){return e.add("template",function(e){a.register(e),t.register(e),n.setup(e)}),function(){}}),a("tinymce.plugins.template.Plugin")()}();